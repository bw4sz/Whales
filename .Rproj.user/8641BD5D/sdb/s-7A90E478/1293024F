{
    "contents" : "sink(\"Bayesian/Multi_RW.jags\")\ncat(\"\n    model{\n    \n    #Constants\n    pi <- 3.141592653589\n    \n    ##argos observation error##\n    argos_prec[1:2,1:2] <- inverse(argos_sigma*argos_cov[,])\n    \n    #Constructing the covariance matrix\n    argos_cov[1,1] <- 1\n    argos_cov[1,2] <- sqrt(argos_alpha) * rho\n    argos_cov[2,1] <- sqrt(argos_alpha) * rho\n    argos_cov[2,2] <- argos_alpha\n    \n    for(i in 1:ind){\n      for(g in 1:tracks[i]){\n\n        ## Priors for first true location\n        #for lat long\n        y[i,g,1,1:2] ~ dmnorm(argos[i,g,1,1,1:2],argos_prec)\n\n        #First movement - random walk.\n        y[i,g,2,1:2] ~ dmnorm(y[i,g,1,1:2],iSigma)\n        \n        ###First Behavioral State###\n        state[i,g,1] ~ dcat(lambda[]) ## assign state for first obs\n        \n        #Process Model for movement\n        for(t in 2:(steps[i,g]-1)){\n        \n        #Behavioral State at time T\n        logit(phi[i,g,t,1]) <- alpha[i,state[i,g,t-1]] + beta[i,state[i,g,t-1]] * ocean[i,g,t] + beta2[i,state[i,g,t-1]] * coast[i,g,t]\n        phi[i,g,t,2] <- 1-phi[i,g,t,1]\n        state[i,g,t] ~ dcat(phi[i,g,t,])\n            \n        #Turning covariate\n        #Transition Matrix for turning angles\n        T[i,g,t,1,1] <- cos(theta[state[i,g,t]])\n        T[i,g,t,1,2] <- (-sin(theta[state[i,g,t]]))\n        T[i,g,t,2,1] <- sin(theta[state[i,g,t]])\n        T[i,g,t,2,2] <- cos(theta[state[i,g,t]])\n        \n        #Correlation in movement change\n        d[i,g,t,1:2] <- y[i,g,t,] + gamma[state[i,g,t]] * T[i,g,t,,] %*% (y[i,g,t,1:2] - y[i,g,t-1,1:2])\n        \n        #Gaussian Displacement\n        y[i,g,t+1,1:2] ~ dmnorm(d[i,g,t,1:2],iSigma)\n      }\n\n    #Final behavior state\n    logit(phi[i,g,steps[i,g],1]) <- alpha[i,state[i,g,steps[i,g]-1]] + beta[i,state[i,g,steps[i,g]-1]] * ocean[i,g,steps[i,g]] + beta2[i,state[i,g,steps[i,g]-1]] * coast[i,g,steps[i,g]]\n    phi[i,g,steps[i,g],2] <- 1-phi[i,g,steps[i,g],1]\n    state[i,g,steps[i,g]] ~ dcat(phi[i,g,steps[i,g],])\n    \n    ##\tMeasurement equation - irregular observations\n    # loops over regular time intervals (t)    \n    \n    for(t in 2:steps[i,g]){\n    \n    # loops over observed locations within interval t\n    for(u in 1:idx[i,g,t]){ \n      zhat[i,g,t,u,1:2] <- (1-j[i,g,t,u]) * y[i,g,t-1,1:2] + j[i,g,t,u] * y[i,g,t,1:2]\n\n        #for each lat and long\n          #argos error\n          argos[i,g,t,u,1:2] ~ dmnorm(zhat[i,g,t,u,1:2],argos_prec)\n          }\n        }\n      }\n    }\n    ###Priors###\n\n    #Process Variance\n    iSigma ~ dwish(R,2)\n    Sigma <- inverse(iSigma)\n    \n    ##Mean Angle\n    tmp[1] ~ dbeta(10, 10)\n    tmp[2] ~ dbeta(10, 10)\n    \n    # prior for theta in 'traveling state'\n    theta[1] <- (2 * tmp[1] - 1) * pi\n    \n    # prior for theta in 'foraging state'    \n    theta[2] <- (tmp[2] * pi * 2)\n    \n    ##Move persistance\n    # prior for gamma (autocorrelation parameter) in state 1\n    gamma[1] ~ dbeta(5,2)\n    \n    # prior for gamma in state 2\n    gamma[2] ~ dbeta(2,5)\n    \n    ##Behavioral States\n    # Following lunn 2012 p85\n    \n    #Hierarchical structure\n    #Intercepts\n    alpha_mu[1] ~ dnorm(0,0.386)\n    alpha_mu[2] ~ dnorm(0,0.386)\n\n    #Variance\n    alpha_tau[1] ~ dt(0,1,1)I(0,)\n    alpha_tau[2] ~ dt(0,1,1)I(0,)\n\n    #Slopes\n    ## Ocean Depth\n    beta_mu[1] ~ dnorm(0,0.386)\n    beta_mu[2] ~ dnorm(0,0.386)\n\n    # Distance coast\n    beta2_mu[1] ~ dnorm(0,0.386)\n    beta2_mu[2] ~ dnorm(0,0.386)\n\n    #Variance\n    #Ocean\n    beta_tau[1] ~ dt(0,1,1)I(0,)\n    beta_tau[2] ~ dt(0,1,1)I(0,)\n    \n    #Coast\n    beta2_tau[1] ~ dt(0,1,1)I(0,)\n    beta2_tau[2] ~ dt(0,1,1)I(0,)\n    \n    #For each individual\n    for(i in 1:ind){\n      # prob of being in state 1 at t, given in state 1 at t-1    \n      #Individual Intercept\n      alpha[i,1] ~ dnorm(alpha_mu[1],alpha_tau[1])\n      \n      #effect of ocean on traveling -> traveling\n      beta[i,1] ~ dnorm(beta_mu[1],beta_tau[1])\n      \n      #effect of coast on traveling -> traveling\n      beta2[i,1] ~ dnorm(beta2_mu[1],beta2_tau[1])\n    \n      #Prob of transition to state 1 given state 2 at t-1\n      alpha[i,2] ~ dnorm(alpha_mu[2],alpha_tau[2])\n\n      #effect of ocean on feeding -> traveling\n      beta[i,2] ~ dnorm(beta_mu[2],beta_tau[2])\n\n      #effect of dist to coast on feeding -> traveling\n      beta2[i,2] ~ dnorm(beta_mu[2],beta_tau[2])\n    \n    }\n    \n    #Probability of behavior switching \n    lambda[1] ~ dbeta(1,1)\n    lambda[2] <- 1 - lambda[1]\n\n    ##Argos priors##\n    #longitudinal argos error\n    argos_sigma ~ dunif(0,10)\n    \n    #latitidunal argos error\n    argos_alpha~dunif(0,10)\n    \n    #correlation in argos error\n    rho ~ dunif(-1, 1)\n    \n\n    }\"\n    ,fill=TRUE)\nsink()\n",
    "created" : 1467227918493.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3390504665",
    "id" : "1293024F",
    "lastKnownWriteTime" : 1467054176,
    "path" : "~/Whales/Bayesian/MultiSpecies.R",
    "project_path" : "Bayesian/MultiSpecies.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}